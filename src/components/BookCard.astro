---
// Book product card with cover, details, and purchase CTAs
interface BookData {
    title: string;
    subtitle?: string;
    coverImage: string;
    ageRange: string;
    skillsCount: number;
    badgeCount: number;
    price: string;
    amazonLink: string;
    directLink: string;
    bestseller?: boolean;
}

interface Props {
    book: BookData;
}

const { book } = Astro.props;
---

<div class="group bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-xl transition-all duration-300 border border-gray-100 hover:border-corporate-primary h-full flex flex-col">
    <!-- Cover Image with Badge -->
    <div class="relative h-72 bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-8">
        {book.bestseller && (
            <div class="absolute top-4 right-4 bg-corporate-secondary text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg">
                BESTSELLER
            </div>
        )}
        <img 
            src={book.coverImage} 
            alt={`${book.title} cover`}
            class="h-full w-auto object-contain shadow-2xl transform group-hover:scale-105 transition-transform duration-500"
            onerror="this.onerror=null;this.src='https://placehold.co/400x600/011F4B/FFFFFF?text=Book+Cover';"
        />
    </div>
    
    <!-- Content -->
    <div class="p-6 flex-1 flex flex-col">
        <!-- Title -->
        <h3 class="text-xl font-bold text-gray-900 mb-2 line-clamp-2">
            {book.title}
        </h3>
        
        {book.subtitle && (
            <p class="text-sm text-gray-600 mb-4">
                {book.subtitle}
            </p>
        )}

        <!-- Meta Info -->
        <div class="flex flex-wrap gap-2 mb-4">
            <span class="inline-flex items-center gap-1 text-xs font-semibold text-corporate-primary bg-corporate-primary/10 px-3 py-1 rounded-full">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"/>
                </svg>
                Ages {book.ageRange}
            </span>
            <span class="inline-flex items-center gap-1 text-xs font-semibold text-gray-700 bg-gray-100 px-3 py-1 rounded-full">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                </svg>
                {book.badgeCount} Badges
            </span>
        </div>

        <!-- Skills -->
        <p class="text-sm text-gray-600 mb-4">
            {book.skillsCount} skills to master
        </p>

        <!-- Spacer to push CTAs to bottom -->
        <div class="flex-1"></div>

        <!-- Price and CTAs -->
        <div class="pt-4 border-t border-gray-100 space-y-3">
            <div class="flex items-baseline justify-between">
                <span class="text-2xl font-bold text-gray-900">{book.price}</span>
                <span class="text-sm text-gray-500">one-time purchase</span>
            </div>

            <!-- Buy Buttons -->
            <div class="grid grid-cols-2 gap-3">
                <a 
                    href={book.amazonLink}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="inline-flex items-center justify-center px-4 py-3 text-sm font-semibold text-gray-900 bg-white border-2 border-gray-900 rounded-lg hover:bg-gray-900 hover:text-white transition-all duration-200"
                >
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M.045 18.02c.072-.116.187-.124.348-.022 3.636 2.11 7.594 3.166 11.87 3.166 2.852 0 5.668-.533 8.447-1.595l.315-.14c.138-.06.234-.1.293-.13.226-.088.39-.046.525.13.12.174.09.336-.12.48-.256.19-.6.41-1.006.654-1.244.743-2.64 1.316-4.185 1.726-1.53.406-3.045.61-4.546.61-2.217 0-4.398-.366-6.547-1.098-2.15-.735-4.138-1.853-5.965-3.355-.165-.14-.24-.25-.21-.41zm23.718-5.76c0 .387-.102.684-.307.89-.203.203-.5.305-.887.305-.375 0-.67-.1-.886-.3-.213-.202-.318-.5-.318-.89 0-.384.107-.682.323-.892.213-.207.51-.31.886-.31.375 0 .672.103.886.31.21.21.315.508.315.892zm-1.684 3.876c-.187-.124-.282-.317-.282-.58 0-.248.095-.438.282-.57.187-.13.407-.196.66-.196.25 0 .47.066.66.196.187.132.282.322.282.57 0 .263-.095.456-.282.58-.19.124-.41.186-.66.186-.253 0-.473-.062-.66-.187zm-11.93-5.04c-.315 0-.577.013-.785.04-.21.026-.417.067-.624.124-.21.057-.433.14-.67.25-.236.11-.486.25-.75.423-.264.173-.55.387-.855.642-.305.255-.636.566-.992.933-.358.366-.743.798-1.155 1.295l-.192.232c-.09.11-.17.21-.236.295-.065.083-.12.15-.165.202-.044.05-.086.086-.124.108-.04.02-.086.03-.14.03-.077 0-.143-.027-.202-.08-.057-.053-.086-.13-.086-.232 0-.04.006-.086.018-.138.013-.054.033-.115.06-.184l.06-.138c.025-.052.05-.1.077-.142.026-.043.055-.088.087-.135.032-.048.066-.097.102-.148.036-.05.074-.104.115-.163.04-.06.083-.122.13-.187.047-.066.096-.135.15-.208.053-.073.11-.15.172-.23.06-.08.127-.165.197-.254.07-.09.145-.184.226-.282.08-.098.167-.2.26-.308.093-.11.192-.223.298-.342.106-.12.218-.244.338-.374.12-.13.247-.265.382-.408.135-.144.277-.293.426-.45.15-.158.307-.32.47-.49.167-.168.34-.343.52-.524.184-.18.375-.366.573-.56.2-.193.41-.392.63-.597l.09-.086c.228-.22.463-.44.705-.66.242-.22.496-.433.76-.64.266-.208.544-.404.835-.59.29-.186.594-.355.913-.507.32-.152.655-.282 1.006-.39.35-.11.718-.193 1.102-.25.383-.06.786-.09 1.207-.09.658 0 1.266.086 1.824.26.56.172 1.043.427 1.454.764.41.337.73.754.963 1.25.232.497.348 1.066.348 1.71 0 .658-.116 1.24-.348 1.746-.233.506-.55.94-.952 1.295-.403.355-.875.638-1.415.85-.54.21-1.12.354-1.738.433l-.232.03c-.077.012-.177.026-.298.043-.12.016-.257.033-.41.05-.152.018-.315.038-.49.062-.174.023-.356.05-.545.082-.19.032-.378.07-.566.115-.19.046-.374.1-.554.163-.18.064-.35.14-.508.23-.157.088-.298.192-.423.31-.125.116-.224.25-.298.4-.074.15-.11.322-.11.517 0 .22.043.414.13.58.087.166.198.306.333.422.136.115.29.204.465.266.173.062.35.093.528.093.337 0 .636-.07.897-.21.26-.14.49-.322.69-.546.196-.224.36-.477.49-.76.13-.283.234-.576.31-.88.078-.305.134-.614.17-.928.035-.315.052-.617.052-.906 0-.15.01-.293.03-.43.018-.136.05-.26.094-.373.044-.113.104-.206.18-.28.076-.073.173-.11.29-.11.145 0 .27.056.378.165.108.11.162.28.162.51 0 .248-.013.522-.04.823-.025.3-.067.613-.124.94-.057.326-.132.655-.225.987-.093.332-.21.655-.35.97-.14.315-.31.613-.51.897-.197.284-.43.54-.696.768-.266.23-.574.414-.922.554-.35.14-.742.21-1.178.21-.436 0-.836-.06-1.202-.18-.366-.12-.68-.294-.945-.523-.266-.23-.473-.512-.622-.85-.15-.337-.225-.72-.225-1.148 0-.467.08-.873.24-1.216.162-.344.378-.638.65-.883.273-.245.59-.447.95-.606.36-.16.74-.286 1.142-.378.4-.093.81-.163 1.228-.21.417-.047.824-.08 1.22-.1l.232-.013c.248-.013.49-.026.725-.04.236-.013.463-.033.68-.06.218-.027.423-.064.616-.11.193-.047.37-.11.533-.19.162-.082.304-.186.425-.315.12-.13.215-.287.284-.472.07-.185.105-.41.105-.675 0-.422-.077-.788-.232-1.098-.155-.31-.366-.566-.633-.768-.267-.203-.58-.354-.94-.454-.36-.1-.744-.15-1.155-.15-.483 0-.94.066-1.372.197-.433.13-.843.31-1.228.536-.386.226-.748.49-1.087.79-.34.3-.654.62-.943.96-.29.34-.553.693-.79 1.06-.238.367-.45.737-.637 1.11-.188.373-.348.745-.48 1.117-.133.372-.238.734-.315 1.087-.077.352-.132.69-.165 1.013-.032.324-.048.623-.048.898 0 .112-.023.207-.07.283-.046.077-.11.14-.19.19-.08.05-.173.086-.28.108-.106.022-.217.033-.333.033-.145 0-.274-.02-.386-.06-.113-.04-.21-.1-.29-.18-.08-.08-.142-.18-.187-.298-.045-.118-.068-.256-.068-.413 0-.248.022-.533.067-.855.044-.322.11-.668.197-1.04.087-.372.196-.762.327-1.17.13-.41.284-.825.463-1.246.178-.422.383-.843.616-1.265.232-.422.495-.838.79-1.246.293-.41.616-.806.968-1.19.352-.383.734-.744 1.145-1.084.41-.34.852-.65 1.324-.932.472-.282.973-.527 1.504-.736.53-.21 1.09-.372 1.678-.49.588-.116 1.204-.175 1.85-.175z"/>
                    </svg>
                    Amazon
                </a>
                <a 
                    href={book.directLink}
                    class="inline-flex items-center justify-center px-4 py-3 text-sm font-semibold text-white bg-corporate-primary rounded-lg hover:bg-corporate-primary/90 shadow-sm hover:shadow-md transition-all duration-200"
                >
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
                    </svg>
                    Buy Direct
                </a>
            </div>

            <!-- Preview link -->
            <a 
                href="#preview"
                class="block text-center text-sm text-corporate-primary hover:text-corporate-secondary font-semibold transition-colors"
            >
                Preview sample pages â†’
            </a>
        </div>
    </div>
</div>