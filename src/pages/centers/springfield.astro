---
// src/pages/centers/springfield.astro
// Moved from src/pages/springfield.astro ‚Üí Added one level of ../ to imports

import CenterLayout from '../../layouts/CenterLayout.astro';
import CenterHero from '../../components/CenterHero.astro';
import CenterQuickInfo from '../../components/CenterQuickInfo.astro';
import DirectorSpotlight from '../../components/DirectorSpotlight.astro';
import WhyChooseUs from '../../components/WhyChooseUs.astro';
import CourseCard from '../../components/CourseCard.astro';
import TestimonialBlock from '../../components/TestimonialBlock.astro';
import FacilityShowcase from '../../components/FacilityShowcase.astro';
import LocationMap from '../../components/LocationMap.astro';

// 1. Fetch specific location data for Springfield
const locationFiles = import.meta.glob('/content/locations/springfield.md', { eager: true });
const locationFile = Object.values(locationFiles)[0];

const locationData = locationFile ? locationFile.frontmatter : null;
const DirectorWelcomeContent = locationFile ? locationFile.Content : null;

// 2. Fetch ALL courses managed by Decap CMS
const courseFiles = import.meta.glob('/content/courses/*.md', { eager: true });
const allCourseFiles = Object.values(courseFiles);

const featuredCourses = allCourseFiles.map(file => ({
    title: file.frontmatter.title,
    instructor: file.frontmatter.instructor,
    rating: file.frontmatter.rating,
    price: file.frontmatter.price,
    heroImage: file.frontmatter.heroImage,
    linkUrl: `/course/${file.file.split('/').pop().replace('.md', '')}`,
}));

// Use fallback data if content file is not found
const fallbackLocation = {
    centerName: 'Springfield Center',
    contact: { 
        phoneNumber: '(555) 123-4567', 
        streetAddress: '123 Main Street, Springfield, OH 45501' 
    },
    director: { 
        name: 'Sarah Johnson', 
        title: 'Center Director', 
        photo: 'https://placehold.co/400x400/FF6600/FFFFFF?text=SJ',
        welcomeMessage: 'A warm welcome from our local director.' 
    },
    heroPhoto: 'https://placehold.co/1200x500/FFC72C/1E1E1E?text=Springfield+Center'
};

const location = locationData || fallbackLocation;

// Center hours
const hours = [
    { day: 'Monday - Friday', time: '3:00 PM - 7:00 PM' },
    { day: 'Saturday', time: '9:00 AM - 1:00 PM' },
    { day: 'Sunday', time: 'Closed' },
];

// Quick facts
const quickFacts = [
    { icon: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶', text: 'Ages 5-18 welcome' },
    { icon: 'üéì', text: 'Certified instructors' },
    { icon: 'üèÜ', text: 'Badge-based learning' },
    { icon: '‚ú®', text: 'Small class sizes' },
];

// Why choose us benefits
const benefits = [
    {
        icon: 'üë•',
        title: 'Personalized Attention',
        description: 'Small class sizes mean every child gets the individual support they need to succeed.'
    },
    {
        icon: 'üéØ',
        title: 'Badge-Based Progress',
        description: 'Students earn digital badges as they master skills, building confidence and motivation.'
    },
    {
        icon: 'üè´',
        title: 'Safe Environment',
        description: 'Modern, secure facility with experienced staff who know every student by name.'
    },
    {
        icon: 'üìö',
        title: 'Proven Curriculum',
        description: 'Research-backed programs that build real-world skills kids will use for life.'
    },
    {
        icon: '‚è∞',
        title: 'Flexible Scheduling',
        description: 'After-school and weekend options that work with your family\'s busy schedule.'
    },
    {
        icon: 'üí∞',
        title: 'Affordable Rates',
        description: 'Quality education at prices families can afford, with sibling discounts available.'
    },
];

// Testimonials
const localTestimonials = [
    { 
        quote: "The best learning center in Springfield! My child's math scores went up immediately.", 
        author: "Jennifer M.", 
        context: "Springfield Parent" 
    },
    { 
        quote: "Wonderful, personalized attention. Sarah the Director knows every kid by name.", 
        author: "Mark L.", 
        context: "Springfield Parent" 
    },
    { 
        quote: "My son used to hate science, but now he loves the badge challenges. Highly recommend!", 
        author: "Tanya P.", 
        context: "Neighboring City Parent" 
    },
];

// Facility photos
const facilityPhotos = [
    { url: 'https://placehold.co/800x800/F5F5F5/1E1E1E?text=Main+Classroom', alt: 'Main classroom' },
    { url: 'https://placehold.co/400x400/FFC72C/1E1E1E?text=Coding+Lab', alt: 'Coding lab' },
    { url: 'https://placehold.co/400x400/FF6600/FFFFFF?text=Reading+Corner', alt: 'Reading corner' },
    { url: 'https://placehold.co/400x400/F5F5F5/1E1E1E?text=Science+Area', alt: 'Science area' },
    { url: 'https://placehold.co/400x400/FFC72C/1E1E1E?text=Art+Studio', alt: 'Art studio' },
    { url: 'https://placehold.co/400x400/FF6600/FFFFFF?text=Activity+Room', alt: 'Activity room' },
    { url: 'https://placehold.co/400x400/F5F5F5/1E1E1E?text=Lobby', alt: 'Lobby area' },
];
---

<CenterLayout title={`${location.centerName} - Local Community Center`}>
    <!-- Hero Section -->
    <CenterHero 
        centerName={location.centerName}
        headline={`Where Springfield Kids Become Confident Learners`}
        description="A local community center dedicated to building core skills in a friendly, approachable environment"
        heroImage={location.heroPhoto}
        primaryCTA={{ text: "Schedule a Visit", href: "/schedule-visit" }}
        secondaryCTA={{ text: "Browse Programs", href: "/programs" }}
    />

    <!-- Quick Info Cards -->
    <CenterQuickInfo 
        phoneNumber={location.contact.phoneNumber}
        address={location.contact.streetAddress}
        hours={hours}
        quickFacts={quickFacts}
    />

    <!-- Director Spotlight -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-4 max-w-6xl">
            <DirectorSpotlight 
                location={location}
                DirectorWelcomeContent={DirectorWelcomeContent}
            />
        </div>
    </section>

    <!-- Why Choose Us -->
    <WhyChooseUs 
        title="Why Families Choose Our Center"
        subtitle="We're more than a learning center‚Äîwe're a community"
        benefits={benefits}
    />

    <!-- Local Programs -->
    <section class="py-16 bg-gray-50">
        <div class="container mx-auto px-4 max-w-6xl">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">Our Programs</h2>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                    Engaging, badge-based learning experiences for every age
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                {featuredCourses.slice(0, 3).map((course) => (
                    <CourseCard
                        course={course}
                        isCorporateStyle={false}
                    />
                ))}
            </div>

            <div class="text-center mt-12">
                <a 
                    href="/programs" 
                    class="inline-flex items-center text-center-primary font-semibold text-lg hover:text-center-accent transition-colors"
                >
                    View all programs
                    <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                    </svg>
                </a>
            </div>
        </div>
    </section>

    <!-- Testimonials -->
    <TestimonialBlock testimonials={localTestimonials} />

    <!-- Facility Showcase -->
    <FacilityShowcase 
        title="Our Safe & Modern Facility"
        photos={facilityPhotos}
        galleryLink="/centers/springfield/gallery"
    />

    <!-- Location Map -->
    <LocationMap 
        address={location.contact.streetAddress}
        centerName={location.centerName}
        mapLink={location.contact.mapLink}
    />
</CenterLayout>