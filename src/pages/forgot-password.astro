---
export const prerender = false;

import CorporateLayout from '../layouts/CorporateLayout.astro';
---

<CorporateLayout title="Reset Password - Mind Foundry">
  <!-- Hero Section -->
  <section class="bg-gradient-to-br from-mf-teal via-mf-blue to-mf-navy py-12 relative overflow-hidden">
    <div class="absolute top-0 right-0 w-64 h-64 bg-mf-pink/20 rounded-full blur-3xl"></div>
    <div class="container mx-auto px-4 max-w-6xl relative z-10 text-center">
      <h1 class="font-display text-h2 text-white mb-2">Reset Your Password</h1>
      <p class="text-lg text-white/90 font-corp-body">We'll help you get back into your account</p>
    </div>
  </section>

  <div class="bg-gradient-to-b from-mf-mint/10 to-white py-12">
    <div class="container mx-auto px-4 max-w-md">

      <!-- Reset Form Card -->
      <div class="bg-white rounded-3xl shadow-2xl p-8">

        <!-- Initial State: Email Input -->
        <div id="email-step">
          <div class="text-center mb-8">
            <div class="w-16 h-16 rounded-full bg-mf-teal/20 flex items-center justify-center text-3xl mx-auto mb-4">
              üîê
            </div>
            <h2 class="font-display text-xl text-text-dark mb-2">Forgot your password?</h2>
            <p class="text-sm text-text-body font-corp-body">
              Enter your email address and we'll send you a link to reset your password.
            </p>
          </div>

          <form id="reset-form" class="space-y-5">
            <div>
              <label class="block text-sm font-corp-body text-text-body mb-1">Email Address</label>
              <input
                type="email"
                name="email"
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-mf-teal focus:border-transparent text-gray-900 bg-white placeholder:text-gray-400"
                placeholder="parent@example.com"
              />
            </div>

            <button
              type="submit"
              class="w-full py-4 bg-gradient-to-r from-mf-teal to-mf-blue text-white font-display rounded-xl hover:opacity-90 transition-opacity shadow-lg"
            >
              Send Reset Link
            </button>
          </form>
        </div>

        <!-- Success State (hidden initially) -->
        <div id="success-step" class="hidden">
          <div class="text-center">
            <div class="w-20 h-20 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-6">
              <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            </div>
            <h2 class="font-display text-xl text-text-dark mb-2">Check Your Email</h2>
            <p class="text-text-body font-corp-body mb-6">
              We've sent a password reset link to <span id="sent-email" class="font-display text-mf-teal"></span>
            </p>
            <p class="text-sm text-text-body font-corp-body mb-8">
              The link will expire in 1 hour. If you don't see the email, check your spam folder.
            </p>

            <button
              id="resend-btn"
              class="w-full py-3 border-2 border-mf-teal text-mf-teal font-display rounded-xl hover:bg-mf-teal/10 transition-colors mb-4"
            >
              Resend Email
            </button>

            <a
              href="/login"
              class="block text-center text-mf-teal hover:text-mf-pink font-corp-body"
            >
              Back to Sign In
            </a>
          </div>
        </div>

        <!-- Divider -->
        <div class="flex items-center gap-4 my-8">
          <div class="flex-1 h-px bg-gray-200"></div>
          <span class="text-sm text-text-body font-corp-body">or</span>
          <div class="flex-1 h-px bg-gray-200"></div>
        </div>

        <!-- Alternative Options -->
        <div class="text-center space-y-4">
          <p class="text-sm text-text-body font-corp-body">
            Remember your password? <a href="/login" class="text-mf-teal hover:text-mf-pink font-display">Sign in</a>
          </p>
          <p class="text-sm text-text-body font-corp-body">
            Don't have an account? <a href="/get-started" class="text-mf-teal hover:text-mf-pink font-display">Create one free</a>
          </p>
        </div>
      </div>

      <!-- Help Link -->
      <p class="text-center text-sm text-text-body font-corp-body mt-6">
        Still having trouble? <a href="/contact" class="text-mf-teal hover:text-mf-pink">Contact support</a>
      </p>

    </div>
  </div>

  <script>
    const resetForm = document.getElementById('reset-form');
    const emailStep = document.getElementById('email-step');
    const successStep = document.getElementById('success-step');
    const sentEmail = document.getElementById('sent-email');
    const resendBtn = document.getElementById('resend-btn');

    resetForm?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(resetForm as HTMLFormElement);
      const email = formData.get('email') as string;

      // In production, this would call an API to send the reset email
      // For now, just show the success state
      if (sentEmail) sentEmail.textContent = email;
      emailStep?.classList.add('hidden');
      successStep?.classList.remove('hidden');
    });

    resendBtn?.addEventListener('click', () => {
      // In production, this would resend the email
      alert('Reset email resent! Check your inbox.');
    });
  </script>
</CorporateLayout>
