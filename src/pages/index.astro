---
import CorporateLayout from '../layouts/CorporateLayout.astro';
import HeroSection from '../components/HeroSection.astro';
import SearchFilterBar from '../components/SearchFilterBar.jsx';
import PathwayCards from '../components/PathwayCards.astro';
import StatsSection from '../components/StatsSection.astro';
import FeatureGrid from '../components/FeatureGrid.astro';
import CourseCard from '../components/CourseCard.astro';
import CTASection from '../components/CTASection.astro';

// Fetch courses from CMS
const courseFiles = import.meta.glob('/content/courses/*.md', { eager: true });
const allCourseFiles = Object.values(courseFiles);

const featuredCourses = allCourseFiles.map(file => ({
    title: file.frontmatter.title,
    instructor: file.frontmatter.instructor,
    rating: file.frontmatter.rating,
    price: file.frontmatter.price,
    heroImage: file.frontmatter.heroImage,
    linkUrl: `/course/${file.file.split('/').pop().replace('.md', '')}`,
}));

// Pathway cards data
const pathways = [
    {
        title: 'Learning Centers',
        description: 'In-person classes and programs at local centers with experienced instructors and hands-on activities',
        icon: 'ğŸ«',
        href: '/centers',
        color: 'text-blue-600'
    },
    {
        title: 'At-Home Books',
        description: 'Self-paced learning materials and workbooks designed for independent study at home',
        icon: 'ğŸ“š',
        href: '/books',
        color: 'text-purple-600'
    },
    {
        title: 'Group Programs',
        description: 'Collaborative learning experiences with partner organizations and community groups',
        icon: 'ğŸ‘¥',
        href: '/orgs',
        color: 'text-green-600'
    },
];

// Stats data
const stats = [
    { number: '10K+', label: 'Active Students', icon: 'ğŸ‘¨â€ğŸ“' },
    { number: '50+', label: 'Learning Centers', icon: 'ğŸ«' },
    { number: '200+', label: 'Courses Available', icon: 'ğŸ“–' },
    { number: '4.9â˜…', label: 'Average Rating', icon: 'â­' },
];

// How it works features
const features = [
    {
        icon: 'ğŸ”',
        title: 'Discover Your Path',
        description: 'Browse thousands of classes, courses, and learning centers. Filter by age, subject, format, and location to find the perfect fit.',
    },
    {
        icon: 'ğŸ¯',
        title: 'Learn & Earn Badges',
        description: 'Students progress through engaging curricula, earning digital badges that recognize mastery and build confidence.',
    },
    {
        icon: 'ğŸ“Š',
        title: 'Track Progress',
        description: 'Monitor growth through portfolios and achievement dashboards. Celebrate milestones and identify areas for growth.',
    },
];
---

<CorporateLayout title="Home - Mind Foundry">
	<!-- Hero Section -->
	<HeroSection 
		title="Badge-Based Learning for Every Child"
		subtitle="Connect with local centers, at-home learning materials, and group programs that build real-world skills through gamified education"
		primaryCTA={{ text: "Find Your Learning Path", href: "/get-started" }}
		secondaryCTA={{ text: "How It Works", href: "#how-it-works" }}
	/>

	<!-- Search Bar -->
	<div class="bg-white py-12">
		<div class="container mx-auto px-4 max-w-4xl">
			<SearchFilterBar client:load /> 
		</div>
	</div>

	<!-- Stats Section -->
	<StatsSection stats={stats} />

	<!-- Pathway Cards -->
	<PathwayCards pathways={pathways} />

	<!-- Featured Courses -->
	<section class="py-20 bg-white">
		<div class="container mx-auto px-4 max-w-6xl">
			<div class="text-center mb-12">
				<h2 class="text-4xl font-bold text-gray-900 mb-4">Featured Online Courses</h2>
				<p class="text-xl text-gray-600 max-w-2xl mx-auto">
					Start learning today with our most popular badge-based courses
				</p>
			</div>

			<div class="grid grid-cols-1 md:grid-cols-3 gap-8">
				{featuredCourses.slice(0, 3).map((course) => (
					<CourseCard
						course={course}
						isCorporateStyle={false}
					/>
				))}
			</div>

			<div class="text-center mt-12">
				<a 
					href="/courses" 
					class="inline-flex items-center text-corporate-primary font-semibold text-lg hover:text-corporate-primary/80 transition-colors"
				>
					Browse all courses
					<svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
					</svg>
				</a>
			</div>
		</div>
	</section>

	<!-- How It Works -->
	<div id="how-it-works">
		<FeatureGrid 
			title="How Mind Foundry Works"
			subtitle="Three simple steps to start your child's learning journey"
			features={features}
		/>
	</div>

	<!-- Final CTA -->
	<CTASection 
		title="Ready to unlock your child's potential?"
		description="Join thousands of families who trust Mind Foundry to build essential skills through engaging, badge-based learning"
		primaryCTA={{ text: "Get Started Today", href: "/get-started" }}
		secondaryCTA={{ text: "Schedule a Tour", href: "/schedule-visit" }}
	/>
</CorporateLayout>